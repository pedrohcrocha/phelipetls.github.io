```r
library(lubridate)
library(stringr)
library(data.table)
library(tidyverse)

data <- readLines(
  "https://raw.githubusercontent.com/hadv/PAR/master/homicides.txt")

pattern <- "[Cc]ause: (.*?)</dd>"
matches <- regmatches(data, regexec(pattern, data))
causes <- sapply(matches, function(x) x[2])
causes <- data.table(causes)
causes <- causes[, causes := str_to_title(causes)]

pattern <- "[Ff]ound on (.*?)</dd>"
matches <- regmatches(data, regexec(pattern, data))
dates <- mdy(sapply(matches, `[`, 2))

pattern <- "-?\\d+\\.\\d+, -?\\d+\\.\\d+"
matches <- regmatches(data, regexec(pattern, data))
matches <- data.table(matches)
long_lat <- separate(matches, matches, into = c("longitude", "latitude"), sep = ", ")

pattern <- "[A-Z][a-z]+ [A-Z][a-z]+"
names <- regmatches(data, regexec(pattern, data))

pattern <- "address\">(.*?)<br />(.*?)</dd>"
pattern <- "address\">(.*?)<br />(.*?), MD (.*?)</dd>"
address <- regmatches(data, regexec(pattern, data))
street <- sapply(address, `[`, 2)
city <- sapply(address, `[`, 3)
MD <- sapply(address, `[`, 4)

pattern <- "[Vv]ictim died at (.*?)</dd>"
matches <- regmatches(data, regexec(pattern, data))
local_death <- sapply(matches, `[`, 2)

replace_nas <- function(x, y) {
  for (i in 1:1250) {
    if (is.na(x[i])) {
      x[i] <- y[i]
    }
  }
  return(x)
}

pattern <- "<dd>(\\w+) (\\w+), (\\d{2}) years old"
matches <- regmatches(data, regexec(pattern, data))
race <- sapply(matches, `[`, 2)
gender <- sapply(matches, `[`, 3)
age <- sapply(matches, `[`, 4)

pattern1 <- "[Gg]ender:? (.*?)<br />"
matches <- regmatches(data, regexec(pattern1, data))
gender1 <- sapply(matches, `[`, 2)
pattern1 <- "[Rr]ace:? (.*?)<br />"
matches <- regmatches(data, regexec(pattern1, data))
race1 <- sapply(matches, `[`, 2)
pattern1 <- "Age: (\\d+) years? old"
matches <- regmatches(data, regexec(pattern1, data))
age1 <- sapply(matches, `[`, 2)

pattern <- "(\\w+) (fe)?male"
matches <- regmatches(data, regexec(pattern, data))
race2 <- sapply(matches, `[`, 2)

pattern <- "(\\d{2}) years old"
matches <- regmatches(data, regexec(pattern, data))
age2 <- sapply(matches, `[`, 2)

race <- replace_nas(race, race1)
race <- replace_nas(race, race2)
age <- replace_nas(age, age1)
gender <- replace_nas(gender, gender1)



homicides <- cbind(causes, dates, long_lat, street, city, MD, local_death, race, gender, age)
```
